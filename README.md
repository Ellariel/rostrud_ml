# Проект на открытых данных портала trudvsem.ru

## Загрузка проекта
Файл с языковой моделью https://nc.cloud.cpur.ru/s/L6WLHZYjTPFidq3      
Установим библиотеку, разработанную ЦПУР для матчинга резюме и вакансий портала "Работа в России" : ``` !git clone https://github.com/CAG-ru/rostrud-ml.git ```    
Установим стандартные библиотеки: ```!pip install -r rostrud_ml/requirements.txt  ```  

В файле rostrud_ml/utils/all_tables_names.yml указать путь к директории, куда будут скачиваться и парситься файлы с резюме, вакансиями (сейчас там "workdir").

Внимание: *config_to_bd_example.yml* - это пример файла конфигурации для подключения к БД, для корректной работы имя файла с конфигурацией должно быть *config_to_bd.yml*, файл необходимо заполнить вашей конфигурацией подключения к БД.

Необходимые шаги по загрузке данных и работе модели описаны в ноутбуке rostrud-ml/Model.ipynb

## Описание модулей

### Предобработка данных

Директория rostrud_ml/utils содержит необходимые модули и словари для общения с базой данных

- *config.py* модуль для подключения к БД, и для забора информации из файла *all_tables_names.yml*
- *config_to_bd_example.yml* пример файла конфигурации для подключения к БД, для корректной работы имя файла с конфигурацией должно быть *config_to_bd.yml*, файл необходимо заполнить вашей конфигурацией подключения к БД.
- *all_tables_names.yml* файл содержащий все необходимые динамичные данные (названия переменных, содержание запроса в БД, и пр)

Директория rostrud_ml/process: 
- *adding_tables_psycopg.py* - модуль содержит класс AddingDataPsycopg, осуществляющий все стандартные действия с БД (создание, переименование, заполнение, удаление таблиц)
- *adding_tables_psycopg_rostrud.py* модуль дополнительный к классу AddingDataPsycopg, содержит специфические функции для проекта
- *cleaning_class.py* - все виды необходимой обработки всех таблиц осуществляются классом CleaningData
- *geti.py* - в модуле описаны функции, необходимые для создания и сохранения хешей (версионирования резюме и вакансий)
- *parsing_xmls.py* - содержит класс Parse и подклассы для каждого вида таблицы, посредством которых осуществляется их парсинг
- *process.py* - функцией производится запуск класса CleaningData  
- *renewal.py* - содержит класс Renewal, с помощью которого последовательно скачивается xml файл с ftp, парсятся нужные данные, обновляются в БД, удаляются временные файлы и папки в бакете
- *unify_cols.py* - модуль для унификации значений трёх атрибутов резюме (описаний доп.сертификатов, доп.информации, достижений (опыт работы))
- *utils.py* - модуль с вспомогательными функциями

### Подбор вакансий: 

Реализация продукта рекомендательной системы состоит из двух этапов: 1) предварительная подготовка актуального корпуса вакансий и резюме, и ПЕРВИЧНОЕ обучение или ПОВТОРНОЕ дообучение модели (при необходимости) 2) реализация процедуры подбора резюме и вакансий

Директория rostrud_ml/matching/preparation содержит файлы: 
- *prepare_data.py* модуль для реализации процедуры обработки нового набора данных для матчинга резюме и вакансий, обучения модели и последующего дообучения модели
- *run.py* объединяющий модуль предварительной подготовки актуального корпуса вакансий и резюме, и дообучение модели при необходимости

Директория rostrud_ml/matching/text_matching содержит файлы: 
- *cosine_similarity_w2v.py* модуль для реализации процедуры расчета косинусного расстояния векторов
- *matching_data.py* модуль для реализации процедуры подбора вакансий и резюме
- *run_matching.py* объединяющий модуль для реализации процедуры подбора резюме и вакансий
- *run_rostrud.py* объединяющий модуль для реализации процедуры подбора вакансий для нового резюме (демо для роструда)
